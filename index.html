<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>WELCOME DesaDL</title>
  <style>
    body {
      background-color: #121212;
      color: #e0e0e0;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }

    input, select, button {
      padding: 10px;
      margin: 10px;
      border-radius: 5px;
      border: none;
      width: 80%;
      background-color: #1f1f1f;
      color: white;
    }

    button {
      background-color: #2196f3;
      color: white;
      cursor: pointer;
    }

    #loadingAnim {
      display: none;
      color: lightgreen;
      margin-top: 10px;
    }

    .peringatan {
      color: orange;
      font-size: 0.9em;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>WELCOME DesaDL</h1>

  <form id="orderForm">
    <select id="tipe">
      <option value="Beli dari Admin">Beli dari Admin</option>
      <option value="Jual ke Admin">Jual ke Admin</option>
    </select>
    
    <input type="number" id="jumlah" placeholder="Jumlah DL" required>
    <input type="text" id="growid" placeholder="Nama Growtopia" required>
    <input type="text" id="nowa" placeholder="Nomor WhatsApp (628xxx)" required>
    
    <input type="file" id="buktiTf" accept="image/*" required>
    <button type="submit">Kirim Pesanan</button>
  </form>

  <div id="loadingAnim">Pesanan sedang dicek dan diproses...</div>

  <div class="peringatan">
    Setelah mengisi form, harap kirim screenshot dan bukti transfer ke admin melalui WhatsApp.
  </div>

  <script>
    const form = document.getElementById("orderForm");

    form.addEventListener("submit", async function(e) {
      e.preventDefault();

      const tipe = document.getElementById("tipe").value;
      const jumlah = document.getElementById("jumlah").value;
      const growid = document.getElementById("growid").value;
      const nowa = document.getElementById("nowa").value;
      const bukti = document.getElementById("buktiTf").files[0];

      if (!bukti) {
        alert("Bukti transfer wajib diupload!");
        return;
      }

      if (!/^\d+$/.test(nowa)) {
        alert("Nomor WA hanya boleh angka!");
        return;
      }

      document.getElementById("loadingAnim").style.display = "block";

      const reader = new FileReader();
      reader.onload = async () => {
        const imageBase64 = reader.result;

        const pesan = `Tipe: ${tipe}%0AJumlah DL: ${jumlah}%0AGrowID: ${growid}%0ANo WA: ${nowa}`;
        const apikey = "5579908;
        const phone = "6285232443263";

        try {
          const response = await fetch(`https://api.callmebot.com/whatsapp.php?phone=${phone}&text=${encodeURIComponent(pesan)}&apikey=${apikey}`);
          if (response.ok) {
            alert("Pesanan berhasil dikirim ke admin. Jangan lupa kirim bukti TF ke WA Admin.");
          } else {
            alert("Sabar ya lagi di prosesðŸ¥°.");
          }
        } catch (error) {
          alert("Terjadi kesalahan saat mengirim pesan.");
        }

        document.getElementById("loadingAnim").style.display = "none";
      };
      reader.readAsDataURL(bukti);
    });
  </script>
</body>
</html>
